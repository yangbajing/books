# 单体架构

在单体架构中，单体应用的不同组件被组合成一个单层和统一的软件应用程序，包含用户界面、服务器和数据库模块，这些都在一个地方进行管理。单体架构在开发产品的初始版本时特别有帮助，因为它可以让您熟悉业务领域，而无需处理非功能性挑战。然而，建议您定期评估您的产品，以了解是否是时候转向微服务架构。现在我们知道单体架构的样子，让我们来看看它的优缺点。

## 开发

所有现代 IDE 都旨在支持单体应用程序。例如，您可以在 IntelliJ IDEA（https://www.jetbrains.com/idea/）中打开一个多模块的 Maven 项目，或者使用 RustRover（https://www.jetbrains.com/rust/）、VSCode（https://code.visualstudio.com/） 创建一个模块化的 Rust 项目，您可以轻松地在代码库中打开和导航。

然而，随着代码库的增长，问题可能会出现。例如，假设您在一个单体应用程序中有许多模块，并且您尝试同时打开它们。在这种情况下，可能会导致 IDE 过载，从而对生产力产生负面影响；如果您不需要其中的一些模块，打开它们全部也可能没有必要。

此外，如果您的测试用例没有适当的隔离，那么每当您对代码库进行小的更改时，可能会运行所有测试。代码库越大，编译和测试的时间就越长。

## 部署

部署单体应用意味着将独立的包或文件夹层次结构复制到服务器或容器运行时。然而，单体应用可能会成为持续部署中频繁部署的障碍，因为它们在合理的时间间隔内难以部署和测试。即使您只对特定组件进行了小的更改，也需要部署整个应用程序。例如，假设我们在负责发送新闻通讯的新闻通讯组件中引入了一个小的更改，我们希望将其测试并部署到生产环境中。我们需要运行所有测试，即使我们没有更改其他组件，如支付、订单等。同样，我们需要构建系统以生成一个工件，即使更改仅在新闻通讯组件中。

然而，部署单体应用可能会带来更严重的问题，特别是当多个团队共享该应用时。其他团队引入的不稳定测试和损坏的功能可能会中断整个部署，您可能希望将其回滚。

## 扩展性

单体应用可以通过将其放置在负载均衡器后面快速扩展，这使得客户端请求能够代理到物理服务器上的下游单体应用或容器运行时。然而，从成本的角度来看，这可能没有意义，因为这些应用是彼此的精确副本，即使您不需要所有组件以相同的优先级进行扩展。让我们看一个简单的例子，以更好地理解这个利用问题。

假设您有一个需要 16 GB 内存的单体应用程序，其中 10 个模块中最关键的是客户服务。当您将这个单体应用程序扩展 2 倍时，您将得到 32 GB 的内存分配。假设自定义模块需要 2 GB 内存才能高效运行。难道不应该只将需要额外 2 GB 内存的客户模块扩展 2 倍，而不是 16 GB 吗？

将单体应用模块分配给不同团队以快速实现功能是另一个具有挑战性的扩展问题。一旦决定使用单体架构，就意味着长期承诺于该技术栈。单体应用中的层紧密耦合，使用相同技术进行进程内调用以实现互操作性。作为开发者或架构师，尝试其他技术栈（当有新的技术栈可用时）将变得更加困难。接下来，让我们看看扩展的驱动因素。
